<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>sol-explain åˆ†æç³»ç»Ÿ - ç®¡ç†åå°</title>
    <!-- Chart.js åº“ -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: #f5f5f5;
            color: #333;
        }

        /* é¡¶éƒ¨å¯¼èˆªæ  */
        .top-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 30px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        .top-header h1 {
            font-size: 1.5em;
            font-weight: 600;
        }

        /* ä¸»å®¹å™¨ */
        .main-container {
            display: flex;
            margin-top: 60px;
            min-height: calc(100vh - 60px);
        }

        /* å·¦ä¾§èœå•æ  */
        .sidebar {
            width: 250px;
            background: white;
            box-shadow: 2px 0 4px rgba(0, 0, 0, 0.1);
            position: fixed;
            left: 0;
            top: 60px;
            bottom: 0;
            overflow-y: auto;
            z-index: 999;
        }

        .menu {
            list-style: none;
            padding: 20px 0;
        }

        .menu-item {
            padding: 0;
        }

        .menu-item a {
            display: block;
            padding: 15px 30px;
            color: #333;
            text-decoration: none;
            transition: all 0.3s;
            border-left: 3px solid transparent;
        }

        .menu-item a:hover {
            background: #f8f9fa;
            border-left-color: #667eea;
            color: #667eea;
        }

        .menu-item a.active {
            background: #f0f0ff;
            border-left-color: #667eea;
            color: #667eea;
            font-weight: 600;
        }

        .menu-item-icon {
            margin-right: 10px;
            font-size: 1.2em;
        }

        /* ä¸»å†…å®¹åŒºåŸŸ */
        .content {
            flex: 1;
            margin-left: 250px;
            padding: 30px;
        }

        .content-header {
            margin-bottom: 30px;
        }

        .content-header h2 {
            font-size: 1.8em;
            color: #333;
            margin-bottom: 10px;
        }

        .content-header p {
            color: #666;
            font-size: 0.95em;
        }

        /* å¡ç‰‡æ ·å¼ */
        .card {
            background: white;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .card h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .sidebar {
                width: 200px;
            }

            .content {
                margin-left: 200px;
                padding: 20px;
            }
        }

        @media (max-width: 600px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s;
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .content {
                margin-left: 0;
            }
        }
    </style>
</head>
<body>
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <div class="top-header">
        <h1>sol-explain åˆ†æç³»ç»Ÿ</h1>
    </div>

    <!-- ä¸»å®¹å™¨ -->
    <div class="main-container">
        <!-- å·¦ä¾§èœå•æ  -->
        <aside class="sidebar">
            <ul class="menu">
                <li class="menu-item">
                    <a href="#token-holders" class="active" onclick="showSection('token-holders', this)">
                        <span class="menu-item-icon">ğŸ“Š</span>
                        ä»£å¸æŒä»“åˆ†æ
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#job-management" onclick="showSection('job-management', this)">
                        <span class="menu-item-icon">âš™ï¸</span>
                        ä»»åŠ¡ç®¡ç†
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#address-monitor" onclick="showSection('address-monitor', this)">
                        <span class="menu-item-icon">ğŸ‘ï¸</span>
                        åœ°å€ç›‘æ§ç®¡ç†
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#address-transactions" onclick="showSection('address-transactions', this)">
                        <span class="menu-item-icon">ğŸ”</span>
                        åœ°å€äº¤æ˜“æŸ¥è¯¢
                    </a>
                </li>
                <li class="menu-item">
                    <a href="#sync-trades" onclick="showSection('sync-trades', this)">
                        <span class="menu-item-icon">ğŸ’¾</span>
                        æŒ‰ç…§åŒºå—æ—¶é—´è·å–ä¹°å…¥ä¿¡æ¯
                    </a>
                </li>
            </ul>
        </aside>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <main class="content">
            <!-- ä»£å¸æŒä»“åˆ†æéƒ¨åˆ† -->
            <div id="section-token-holders" class="content-section">
                <div class="content-header">
                    <h2>ğŸ“Š ä»£å¸æŒä»“åˆ†æ</h2>
                    <p>åˆ†æä»£å¸æŒæœ‰äººçš„æŒä»“æƒ…å†µï¼Œæ”¯æŒåˆ†é¡µæŸ¥è¯¢å’Œè¿‡æ»¤æµåŠ¨æ€§æ± åœ°å€</p>
                </div>

                <div class="card">
                    <h3>æŸ¥è¯¢ä»£å¸æŒæœ‰äºº</h3>
                    <div style="margin-top: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 500;">ä»£å¸åœ°å€</label>
                        <input 
                            type="text" 
                            id="tokenAddress" 
                            placeholder="è¯·è¾“å…¥ä»£å¸åœ°å€"
                            style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; margin-bottom: 15px;"
                        />
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 500;">åç§»é‡ (offset)</label>
                                <input 
                                    type="number" 
                                    id="offset" 
                                    value="0"
                                    style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"
                                />
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 500;">æ¯é¡µæ•°é‡ (limit)</label>
                                <input 
                                    type="number" 
                                    id="limit" 
                                    value="100"
                                    style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"
                                />
                            </div>
                        </div>


                        <div style="margin-bottom: 15px;">
                            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                <input type="checkbox" id="filterPools" checked />
                                <span>è¿‡æ»¤æµåŠ¨æ€§æ± å’Œäº¤æ˜“æ‰€åœ°å€</span>
                            </label>
                        </div>

                        <div style="margin-bottom: 15px;">
                            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                <input type="checkbox" id="enableClustering" />
                                <span>å¯ç”¨åœ°å€èšç±»ï¼ˆè¯†åˆ«å…³è”åœ°å€ï¼Œè¾ƒæ…¢ä½†æ›´å‡†ç¡®ï¼‰</span>
                            </label>
                            <small style="display: block; margin-top: 5px; color: #666; font-size: 12px;">
                                åœ°å€èšç±»ä¼šåˆ†æåœ°å€ä¹‹é—´çš„äº¤æ˜“å…³ç³»ï¼Œè¯†åˆ«å¹¶åˆå¹¶å…³è”åœ°å€çš„æŒä»“ï¼Œç±»ä¼¼ Axiom çš„åŠŸèƒ½
                            </small>
                        </div>

                        <button 
                            onclick="queryTokenHolders()" 
                            style="background: #667eea; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 14px; font-weight: 500; transition: background 0.3s;"
                            onmouseover="this.style.background='#5568d3'"
                            onmouseout="this.style.background='#667eea'"
                        >
                            æŸ¥è¯¢æŒæœ‰äºº
                        </button>
                    </div>

                    <div id="queryResult" style="margin-top: 20px; display: none;">
                        <!-- æŸ¥è¯¢ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
                    </div>
                </div>

                <div class="card">
                    <h3>æŒä»“å æ¯”è¶‹åŠ¿åˆ†æ</h3>
                    <p style="color: #666; margin-bottom: 20px; font-size: 0.9em;">
                        æ ¹æ®æ‰¹æ¬¡æ—¶é—´æ±‡æ€»ä»£å¸æ‰€æœ‰åœ°å€çš„æŒä»“å æ¯”ï¼Œå±•ç¤ºæŒä»“å æ¯”éšæ—¶é—´çš„å˜åŒ–è¶‹åŠ¿
                    </p>
                    <div style="margin-top: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 500;">ä»£å¸åœ°å€ (spl_addr)</label>
                        <input 
                            type="text" 
                            id="summaryTokenAddress" 
                            placeholder="è¯·è¾“å…¥ä»£å¸åœ°å€"
                            style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; margin-bottom: 15px;"
                        />
                        
                        <button 
                            onclick="queryHoldersSummary()" 
                            style="background: #667eea; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 14px; font-weight: 500; transition: background 0.3s;"
                            onmouseover="this.style.background='#5568d3'"
                            onmouseout="this.style.background='#667eea'"
                        >
                            æŸ¥è¯¢æŒä»“å æ¯”è¶‹åŠ¿
                        </button>
                    </div>

                    <div id="summaryResult" style="margin-top: 20px; display: none;">
                        <!-- æŠ˜çº¿å›¾å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
                    </div>
                </div>

                <div class="card">
                    <h3>åœ°å€äº¤æ˜“å†å²æŸ¥è¯¢</h3>
                    <p style="color: #666; margin-bottom: 20px; font-size: 0.9em;">
                        æŸ¥è¯¢ä»»æ„ Solana åœ°å€ï¼ˆé’±åŒ…ã€ç¨‹åºIDã€ä»£å¸é“¸å¸åœ°å€ç­‰ï¼‰çš„è¯¦ç»†äº¤æ˜“å†å²ï¼ŒåŒ…æ‹¬äº¤æ˜“ç­¾åã€æ—¶é—´ã€çŠ¶æ€ã€ç¨‹åºäº¤äº’ç­‰ä¿¡æ¯
                    </p>
                    <div style="margin-top: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 500;">åœ°å€</label>
                        <input 
                            type="text" 
                            id="historyAddress" 
                            placeholder="è¯·è¾“å…¥åœ°å€ï¼ˆé’±åŒ…ã€ç¨‹åºIDã€ä»£å¸é“¸å¸åœ°å€ç­‰ï¼‰"
                            style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; margin-bottom: 15px;"
                        />
                        
                        <div style="margin-bottom: 15px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 500;">æŸ¥è¯¢æ•°é‡ (limit)</label>
                            <input 
                                type="number" 
                                id="historyLimit" 
                                value="30"
                                min="1"
                                max="50"
                                style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"
                            />
                            <small style="color: #666; font-size: 0.85em;">
                                å»ºè®® 30-100 æ¡ï¼ˆä½¿ç”¨ dRPC æ—¶é™åˆ¶æ›´å®½æ¾ï¼Œæœ€å¤§ 200 æ¡ï¼‰
                            </small>
                        </div>
                        
                        <button 
                            onclick="queryAddressHistory()" 
                            style="background: #667eea; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 14px; font-weight: 500; transition: background 0.3s;"
                            onmouseover="this.style.background='#5568d3'"
                            onmouseout="this.style.background='#667eea'"
                        >
                            æŸ¥è¯¢äº¤æ˜“å†å²
                        </button>
                    </div>

                    <div id="historyResult" style="margin-top: 20px; display: none;">
                        <!-- äº¤æ˜“å†å²å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
                    </div>
                </div>
            </div>

            <!-- ä»»åŠ¡ç®¡ç†éƒ¨åˆ† -->
            <div id="section-job-management" class="content-section" style="display: none;">
                <div class="content-header">
                    <h2>âš™ï¸ ä»»åŠ¡ç®¡ç†</h2>
                    <p>ç®¡ç†å’Œç›‘æ§å®šæ—¶ä»»åŠ¡ï¼Œæ”¯æŒå¯åŠ¨ã€åœæ­¢å’ŒæŸ¥çœ‹ä»»åŠ¡çŠ¶æ€</p>
                </div>

                <div class="card">
                    <h3>å®šæ—¶ä»»åŠ¡åˆ—è¡¨</h3>
                    <button 
                        onclick="loadScheduledJobs()" 
                        style="background: #667eea; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 14px; font-weight: 500; margin-bottom: 20px;"
                        onmouseover="this.style.background='#5568d3'"
                        onmouseout="this.style.background='#667eea'"
                    >
                        ğŸ”„ åˆ·æ–°åˆ—è¡¨
                    </button>
                    <div id="scheduledJobsList" style="margin-top: 20px;">
                        <div style="text-align: center; padding: 20px; color: #666;">åŠ è½½ä¸­...</div>
                    </div>
                </div>

                <div class="card">
                    <h3>å¯ç”¨ä»»åŠ¡åˆ—è¡¨</h3>
                    <div id="taskList" style="margin-top: 20px;">
                        <div style="text-align: center; padding: 20px; color: #666;">åŠ è½½ä¸­...</div>
                    </div>
                </div>

                <div class="card">
                    <h3>é˜Ÿåˆ—çŠ¶æ€</h3>
                    <button 
                        onclick="refreshQueueStatus()" 
                        style="background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 14px; font-weight: 500; margin-bottom: 20px;"
                        onmouseover="this.style.background='#5a6268'"
                        onmouseout="this.style.background='#6c757d'"
                    >
                        ğŸ”„ åˆ·æ–°çŠ¶æ€
                    </button>
                    <div id="queueStatus" style="margin-top: 20px;">
                        <div style="text-align: center; padding: 20px; color: #666;">åŠ è½½ä¸­...</div>
                    </div>
                </div>
            </div>

            <!-- åœ°å€äº¤æ˜“æŸ¥è¯¢éƒ¨åˆ† -->
            <div id="section-address-transactions" class="content-section" style="display: none;">
                <div class="content-header">
                    <h2>ğŸ” åœ°å€äº¤æ˜“æŸ¥è¯¢</h2>
                    <p>ä½¿ç”¨ Helius å¢å¼º API æŸ¥è¯¢ä»»æ„åœ°å€çš„äº¤æ˜“å†å²ï¼Œæ”¯æŒé«˜çº§è¿‡æ»¤ã€æ’åºå’Œåˆ†é¡µ</p>
                </div>

                <div class="card">
                    <h3>æŸ¥è¯¢åœ°å€äº¤æ˜“</h3>
                    <p style="color: #666; margin-bottom: 20px; font-size: 0.9em;">
                        æ”¯æŒæŸ¥è¯¢é’±åŒ…åœ°å€ã€ç¨‹åºIDã€ä»£å¸é“¸å¸åœ°å€ã€ä»£å¸è´¦æˆ·åœ°å€ç­‰ä»»æ„ Solana åœ°å€çš„äº¤æ˜“å†å²
                    </p>
                    <div style="margin-top: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 500;">åœ°å€</label>
                        <input 
                            type="text" 
                            id="txAddress" 
                            placeholder="è¯·è¾“å…¥åœ°å€ï¼ˆé’±åŒ…ã€ç¨‹åºIDã€ä»£å¸é“¸å¸åœ°å€ç­‰ï¼‰"
                            style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; margin-bottom: 15px;"
                        />
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 500;">æŸ¥è¯¢æ•°é‡ (limit)</label>
                                <input 
                                    type="number" 
                                    id="txLimit" 
                                    value="50"
                                    min="1"
                                    max="100"
                                    style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"
                                />
                                <small style="color: #666; font-size: 0.85em;">æœ€å¤§ 100 æ¡ï¼ˆä½¿ç”¨å®Œæ•´è¯¦æƒ…æ¨¡å¼æ—¶ï¼‰</small>
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 500;">æ’åºé¡ºåº</label>
                                <select 
                                    id="txSortOrder" 
                                    style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"
                                >
                                    <option value="desc">é™åºï¼ˆæœ€æ–°ä¼˜å…ˆï¼‰</option>
                                    <option value="asc">å‡åºï¼ˆæœ€æ—§ä¼˜å…ˆï¼‰</option>
                                </select>
                            </div>
                        </div>

                        <div style="margin-bottom: 15px; padding: 15px; background: #f8f9fa; border-radius: 5px;">
                            <h4 style="margin: 0 0 10px 0; font-size: 1em;">è¿‡æ»¤æ¡ä»¶ï¼ˆå¯é€‰ï¼‰</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                                <div>
                                    <label style="display: block; margin-bottom: 8px; font-weight: 500;">äº¤æ˜“çŠ¶æ€</label>
                                    <select 
                                        id="txStatus" 
                                        style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"
                                    >
                                        <option value="">å…¨éƒ¨</option>
                                        <option value="succeeded">æˆåŠŸ</option>
                                        <option value="failed">å¤±è´¥</option>
                                    </select>
                                </div>
                                <div>
                                    <label style="display: block; margin-bottom: 8px; font-weight: 500;">Slot èµ·å§‹å€¼ (gte)</label>
                                    <input 
                                        type="number" 
                                        id="txSlotGte" 
                                        placeholder="å¯é€‰"
                                        style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"
                                    />
                                </div>
                                <div>
                                    <label style="display: block; margin-bottom: 8px; font-weight: 500;">Slot ç»“æŸå€¼ (lt)</label>
                                    <input 
                                        type="number" 
                                        id="txSlotLt" 
                                        placeholder="å¯é€‰"
                                        style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"
                                    />
                                </div>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 15px;">
                                <div>
                                    <label style="display: block; margin-bottom: 8px; font-weight: 500;">å¼€å§‹æ—¶é—´ (gte)</label>
                                    <input 
                                        type="datetime-local" 
                                        id="txBlockTimeGte" 
                                        placeholder="å¯é€‰"
                                        style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"
                                    />
                                    <small style="color: #666; font-size: 0.85em;">æŸ¥è¯¢æ­¤æ—¶é—´ä¹‹åçš„äº¤æ˜“</small>
                                </div>
                                <div>
                                    <label style="display: block; margin-bottom: 8px; font-weight: 500;">ç»“æŸæ—¶é—´ (lt)</label>
                                    <input 
                                        type="datetime-local" 
                                        id="txBlockTimeLt" 
                                        placeholder="å¯é€‰"
                                        style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"
                                    />
                                    <small style="color: #666; font-size: 0.85em;">æŸ¥è¯¢æ­¤æ—¶é—´ä¹‹å‰çš„äº¤æ˜“</small>
                                </div>
                            </div>
                        </div>
                        
                        <button 
                            onclick="queryAddressTransactions()" 
                            style="background: #667eea; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 14px; font-weight: 500; transition: background 0.3s;"
                            onmouseover="this.style.background='#5568d3'"
                            onmouseout="this.style.background='#667eea'"
                        >
                            æŸ¥è¯¢äº¤æ˜“
                        </button>
                    </div>

                    <div id="txResult" style="margin-top: 20px; display: none;">
                        <!-- æŸ¥è¯¢ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
                    </div>
                </div>
            </div>

            <!-- æŒ‰ç…§åŒºå—æ—¶é—´è·å–ä¹°å…¥ä¿¡æ¯éƒ¨åˆ† -->
            <div id="section-sync-trades" class="content-section" style="display: none;">
                <div class="content-header">
                    <h2>ğŸ’¾ æŒ‰ç…§åŒºå—æ—¶é—´è·å–ä¹°å…¥ä¿¡æ¯</h2>
                    <p>æ ¹æ®åŒºå—æ—¶é—´èŒƒå›´åŒæ­¥æŒ‡å®šåœ°å€çš„ä¹°å…¥äº¤æ˜“åˆ°æ•°æ®åº“ï¼Œæ”¯æŒ buy å’Œ swap ç±»å‹äº¤æ˜“</p>
                </div>

                <div class="card">
                    <h3>åŒæ­¥äº¤æ˜“åˆ°æ•°æ®åº“</h3>
                    <p style="color: #666; margin-bottom: 20px; font-size: 0.9em;">
                        æ ¹æ®åŒºå—æ—¶é—´èŒƒå›´è·å–æŒ‡å®šåœ°å€çš„ä¹°å…¥äº¤æ˜“ï¼ˆbuy å’Œ swapï¼‰ï¼Œå¹¶ä¿å­˜åˆ°æ•°æ®åº“ã€‚ä»»åŠ¡åœ¨åå°å¼‚æ­¥æ‰§è¡Œã€‚
                    </p>
                    <div style="margin-top: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 500;">åœ°å€ (address) <span style="color: #dc3545;">*</span></label>
                        <input 
                            type="text" 
                            id="syncAddress" 
                            placeholder="è¯·è¾“å…¥åœ°å€ï¼ˆé’±åŒ…åœ°å€æˆ–ä»£å¸åœ°å€ï¼‰"
                            style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; margin-bottom: 15px; font-family: monospace;"
                        />
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 500;">å¼€å§‹æ—¶é—´ (blockTimeGte) <span style="color: #dc3545;">*</span></label>
                                <input 
                                    type="datetime-local" 
                                    id="syncBlockTimeGte" 
                                    step="1"
                                    style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"
                                />
                                <small style="color: #666; font-size: 0.85em;">é€‰æ‹©å¼€å§‹æ—¥æœŸå’Œæ—¶é—´ï¼ˆç²¾ç¡®åˆ°ç§’ï¼‰</small>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 500;">ç»“æŸæ—¶é—´ (blockTimeLt) <span style="color: #dc3545;">*</span></label>
                                <input 
                                    type="datetime-local" 
                                    id="syncBlockTimeLt" 
                                    step="1"
                                    style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"
                                />
                                <small style="color: #666; font-size: 0.85em;">é€‰æ‹©ç»“æŸæ—¥æœŸå’Œæ—¶é—´ï¼ˆç²¾ç¡®åˆ°ç§’ï¼‰</small>
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 500;">æœ€å¤§æŒç»­æ—¶é—´ (maxDuration)</label>
                                <input 
                                    type="number" 
                                    id="syncMaxDuration" 
                                    value="900000"
                                    placeholder="æ¯«ç§’"
                                    style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"
                                />
                                <small style="color: #666; font-size: 0.85em;">é»˜è®¤ 900000 æ¯«ç§’ï¼ˆ15åˆ†é’Ÿï¼‰</small>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 500;">æœ€å¤§é¡µæ•° (maxPages)</label>
                                <input 
                                    type="number" 
                                    id="syncMaxPages" 
                                    value="500"
                                    placeholder="é¡µæ•°"
                                    style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"
                                />
                                <small style="color: #666; font-size: 0.85em;">é»˜è®¤ 500 é¡µ</small>
                            </div>
                        </div>

                        <div style="margin-bottom: 15px; padding: 15px; background: #f8f9fa; border-radius: 5px;">
                            <h4 style="margin: 0 0 10px 0; font-size: 1em;">é€‰é¡¹</h4>
                            <div style="display: flex; align-items: center; gap: 10px; cursor: pointer; margin-bottom: 10px;">
                                <input type="checkbox" id="syncSkipTimezoneConversion" checked />
                                <label for="syncSkipTimezoneConversion" style="cursor: pointer; margin: 0;">
                                    <span>è·³è¿‡æ—¶åŒºè½¬æ¢ (skipTimezoneConversion)</span>
                                </label>
                            </div>
                            <small style="color: #666; font-size: 0.85em; display: block; margin-top: 5px;">
                                å¦‚æœå‹¾é€‰ï¼Œä¼ å…¥çš„æ—¶é—´æˆ³å°†è¢«è§†ä¸º UTC æ—¶é—´ï¼ˆé“¾ä¸Šæ—¶é—´ï¼‰ã€‚å¦‚æœä¸å‹¾é€‰ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å°†åŒ—äº¬æ—¶é—´è½¬æ¢ä¸º UTC æ—¶é—´ã€‚
                            </small>
                        </div>
                        
                        <button 
                            onclick="syncTradesToDatabase()" 
                            style="background: #667eea; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 14px; font-weight: 500; transition: background 0.3s;"
                            onmouseover="this.style.background='#5568d3'"
                            onmouseout="this.style.background='#667eea'"
                        >
                            ğŸš€ å¼€å§‹åŒæ­¥
                        </button>
                    </div>

                    <div id="syncResult" style="margin-top: 20px; display: none;">
                        <!-- åŒæ­¥ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
                    </div>
                </div>
            </div>

            <!-- åœ°å€ç›‘æ§ç®¡ç†éƒ¨åˆ† -->
            <div id="section-address-monitor" class="content-section" style="display: none;">
                <div class="content-header">
                    <h2>ğŸ‘ï¸ åœ°å€ç›‘æ§ç®¡ç†</h2>
                    <p>å®æ—¶ç›‘æ§ Solana åœ°å€çš„äº¤æ˜“æ´»åŠ¨ï¼Œè‡ªåŠ¨è§£æ swap/transfer äº¤æ˜“</p>
                </div>

                <div class="card">
                    <h3>æ·»åŠ ç›‘æ§åœ°å€</h3>
                    <div style="margin-top: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 500;">åœ°å€</label>
                        <input 
                            type="text" 
                            id="monitorAddress" 
                            placeholder="è¯·è¾“å…¥è¦ç›‘æ§çš„ Solana åœ°å€"
                            style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; margin-bottom: 15px; font-family: monospace;"
                        />
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 500;">ç¼–ç æ ¼å¼</label>
                                <select 
                                    id="monitorEncoding" 
                                    style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"
                                >
                                    <option value="jsonParsed" selected>jsonParsed</option>
                                    <option value="base58">base58</option>
                                    <option value="base64">base64</option>
                                </select>
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 500;">ç¡®è®¤çº§åˆ«</label>
                                <select 
                                    id="monitorCommitment" 
                                    style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;"
                                >
                                    <option value="confirmed">confirmed</option>
                                    <option value="finalized">finalized</option>
                                    <option value="processed" selected>processed</option>
                                </select>
                            </div>
                        </div>

                        <button 
                            onclick="addMonitorAddress()" 
                            style="background: #667eea; color: white; border: none; padding: 12px 24px; border-radius: 5px; cursor: pointer; font-size: 14px; font-weight: 500; transition: background 0.3s;"
                            onmouseover="this.style.background='#5568d3'"
                            onmouseout="this.style.background='#667eea'"
                        >
                            â• æ·»åŠ ç›‘æ§
                        </button>
                    </div>
                </div>

                <div class="card">
                    <h3>å½“å‰ç›‘æ§åˆ—è¡¨</h3>
                    <button 
                        onclick="loadMonitorConnections()" 
                        style="background: #667eea; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 14px; font-weight: 500; margin-bottom: 20px;"
                        onmouseover="this.style.background='#5568d3'"
                        onmouseout="this.style.background='#667eea'"
                    >
                        ğŸ”„ åˆ·æ–°åˆ—è¡¨
                    </button>
                    <div id="monitorConnectionsList" style="margin-top: 20px;">
                        <div style="text-align: center; padding: 20px; color: #666;">åŠ è½½ä¸­...</div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // åˆ‡æ¢èœå•é¡¹
        function showSection(sectionId, element) {
            // ç§»é™¤æ‰€æœ‰æ´»åŠ¨çŠ¶æ€
            document.querySelectorAll('.menu-item a').forEach(a => a.classList.remove('active'));
            // æ·»åŠ å½“å‰æ´»åŠ¨çŠ¶æ€
            element.classList.add('active');

            // éšè—æ‰€æœ‰å†…å®¹åŒºåŸŸ
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
            });

            // æ˜¾ç¤ºé€‰ä¸­çš„å†…å®¹åŒºåŸŸ
            const section = document.getElementById(`section-${sectionId}`);
            if (section) {
                section.style.display = 'block';
            }
        }

        // æŸ¥è¯¢ä»£å¸æŒæœ‰äºº
        async function queryTokenHolders() {
            const tokenAddress = document.getElementById('tokenAddress').value.trim();
            const offset = parseInt(document.getElementById('offset').value) || 0;
            const limit = parseInt(document.getElementById('limit').value) || 100;
            const filterPools = document.getElementById('filterPools').checked;
            const enableClustering = document.getElementById('enableClustering').checked;

            if (!tokenAddress) {
                alert('è¯·è¾“å…¥ä»£å¸åœ°å€');
                return;
            }

            const resultDiv = document.getElementById('queryResult');
            resultDiv.style.display = 'block';
            if (enableClustering) {
                resultDiv.innerHTML = '<div style="text-align: center; padding: 20px;">åŠ è½½ä¸­...<br/><small style="color: #666;">åœ°å€èšç±»åˆ†æå¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ï¼Œè¯·è€å¿ƒç­‰å¾…</small></div>';
            } else {
            resultDiv.innerHTML = '<div style="text-align: center; padding: 20px;">åŠ è½½ä¸­...</div>';
            }

            try {
                const params = new URLSearchParams({
                    offset: offset,
                    limit: limit,
                    filterPools: filterPools,
                    enableClustering: enableClustering
                });

                const response = await fetch(`/api/token/${tokenAddress}/holders?${params}`);
                const data = await response.json();

                if (data.success) {
                    resultDiv.innerHTML = `
                        <div style="background: #d4edda; color: #155724; padding: 15px; border-radius: 5px; margin-bottom: 20px;">
                            <strong>âœ… æŸ¥è¯¢æˆåŠŸ</strong>
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                            <div>
                                <div style="color: #666; font-size: 0.9em;">æ€»æŒæœ‰äººæ•°</div>
                                <div style="font-size: 1.5em; font-weight: bold; color: #333;">${data.totalHolders || 0}</div>
                            </div>
                            <div>
                                <div style="color: #666; font-size: 0.9em;">è¿‡æ»¤æ•°é‡</div>
                                <div style="font-size: 1.5em; font-weight: bold; color: #333;">${data.filtered || 0}</div>
                            </div>
                            <div>
                                <div style="color: #666; font-size: 0.9em;">æ€»ä¾›åº”é‡</div>
                                <div style="font-size: 1.5em; font-weight: bold; color: #333;">${data.totalSupply || 0}</div>
                            </div>
                        </div>
                        ${data.holders && data.holders.length > 0 ? `
                            <div style="overflow-x: auto;">
                                <table style="width: 100%; border-collapse: collapse;">
                                    <thead>
                                        <tr style="background: #f8f9fa;">
                                            <th style="padding: 12px; text-align: left; border-bottom: 2px solid #dee2e6;">æ’å</th>
                                            <th style="padding: 12px; text-align: left; border-bottom: 2px solid #dee2e6;">åœ°å€${data.clustered ? 'ï¼ˆå·²èšç±»ï¼‰' : ''}</th>
                                            ${data.clustered ? '<th style="padding: 12px; text-align: center; border-bottom: 2px solid #dee2e6;">å…³è”åœ°å€</th>' : ''}
                                            <th style="padding: 12px; text-align: right; border-bottom: 2px solid #dee2e6;">æŒä»“æ•°é‡</th>
                                            <th style="padding: 12px; text-align: right; border-bottom: 2px solid #dee2e6;">æŒä»“ç™¾åˆ†æ¯”</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${data.holders.map(holder => `
                                            <tr style="border-bottom: 1px solid #dee2e6;">
                                                <td style="padding: 12px;">${holder.rank || '-'}</td>
                                                <td style="padding: 12px; font-family: monospace; font-size: 0.9em;">
                                                    ${holder.address}
                                                    ${holder.addressCount > 1 ? `<br/><small style="color: #666;">(${holder.addressCount} ä¸ªåœ°å€åˆå¹¶)</small>` : ''}
                                                </td>
                                                ${data.clustered ? `
                                                    <td style="padding: 12px; text-align: center;">
                                                        ${holder.relatedAddresses && holder.relatedAddresses.length > 0 
                                                            ? `<span style="color: #28a745; font-weight: bold;">${holder.relatedAddresses.length}</span>` 
                                                            : '<span style="color: #999;">-</span>'}
                                                    </td>
                                                ` : ''}
                                                <td style="padding: 12px; text-align: right;">${parseFloat(holder.uiAmount || 0).toLocaleString()}</td>
                                                <td style="padding: 12px; text-align: right;">${parseFloat(holder.percentage || 0).toFixed(4)}%</td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        ` : '<p style="text-align: center; color: #666; padding: 20px;">æš‚æ— æŒæœ‰äººæ•°æ®</p>'}
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 5px;">
                            <strong>âŒ æŸ¥è¯¢å¤±è´¥</strong><br>
                            ${data.error || 'æœªçŸ¥é”™è¯¯'}
                        </div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 5px;">
                        <strong>âŒ è¯·æ±‚å¤±è´¥</strong><br>
                        ${error.message}
                    </div>
                `;
            }
        }

        // æŸ¥è¯¢æŒä»“å æ¯”æ±‡æ€»
        let chartInstance = null;

        async function queryHoldersSummary() {
            const tokenAddress = document.getElementById('summaryTokenAddress').value.trim();

            if (!tokenAddress) {
                alert('è¯·è¾“å…¥ä»£å¸åœ°å€');
                return;
            }

            const resultDiv = document.getElementById('summaryResult');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '<div style="text-align: center; padding: 20px;">åŠ è½½ä¸­...</div>';

            try {
                const response = await fetch(`/api/token/${tokenAddress}/holders/summary`);
                const data = await response.json();

                if (data.success && data.summary && data.summary.length > 0) {
                    // å‡†å¤‡å›¾è¡¨æ•°æ®
                    const labels = data.summary.map(item => {
                        const date = new Date(item.batchTime);
                        return date.toLocaleString('zh-CN', { 
                            month: '2-digit', 
                            day: '2-digit', 
                            hour: '2-digit', 
                            minute: '2-digit' 
                        });
                    });
                    const totalPercentData = data.summary.map(item => item.totalPercent);
                    const maxPercentData = data.summary.map(item => item.maxPercent);
                    const avgPercentData = data.summary.map(item => item.avgPercent);

                    // é”€æ¯ä¹‹å‰çš„å›¾è¡¨å®ä¾‹
                    if (chartInstance) {
                        chartInstance.destroy();
                    }

                    // åˆ›å»ºå›¾è¡¨å®¹å™¨
                    resultDiv.innerHTML = `
                        <div style="margin-bottom: 20px;">
                            <div style="background: #d4edda; color: #155724; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                                <strong>âœ… æŸ¥è¯¢æˆåŠŸ</strong><br>
                                å…±æ‰¾åˆ° ${data.summary.length} ä¸ªæ‰¹æ¬¡æ—¶é—´ç‚¹
                            </div>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                                    <div>
                                        <div style="color: #666; font-size: 0.9em;">å¹³å‡æ€»æŒä»“å æ¯”</div>
                                        <div style="font-size: 1.5em; font-weight: bold; color: #333;">
                                            ${(totalPercentData.reduce((a, b) => a + b, 0) / totalPercentData.length).toFixed(2)}%
                                        </div>
                                    </div>
                                    <div>
                                        <div style="color: #666; font-size: 0.9em;">æœ€å¤§æŒä»“å æ¯”</div>
                                        <div style="font-size: 1.5em; font-weight: bold; color: #333;">
                                            ${Math.max(...maxPercentData).toFixed(2)}%
                                        </div>
                                    </div>
                                    <div>
                                        <div style="color: #666; font-size: 0.9em;">å¹³å‡å•åœ°å€å æ¯”</div>
                                        <div style="font-size: 1.5em; font-weight: bold; color: #333;">
                                            ${(avgPercentData.reduce((a, b) => a + b, 0) / avgPercentData.length).toFixed(4)}%
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <canvas id="holdersChart" style="max-height: 400px;"></canvas>
                        </div>
                    `;

                    // åˆ›å»ºæŠ˜çº¿å›¾
                    const ctx = document.getElementById('holdersChart').getContext('2d');
                    chartInstance = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [
                                {
                                    label: 'æ€»æŒä»“å æ¯” (%)',
                                    data: totalPercentData,
                                    borderColor: 'rgb(102, 126, 234)',
                                    backgroundColor: 'rgba(102, 126, 234, 0.1)',
                                    tension: 0.4,
                                    fill: true
                                },
                                {
                                    label: 'æœ€å¤§æŒä»“å æ¯” (%)',
                                    data: maxPercentData,
                                    borderColor: 'rgb(255, 99, 132)',
                                    backgroundColor: 'rgba(255, 99, 132, 0.1)',
                                    tension: 0.4,
                                    fill: false
                                },
                                {
                                    label: 'å¹³å‡æŒä»“å æ¯” (%)',
                                    data: avgPercentData,
                                    borderColor: 'rgb(75, 192, 192)',
                                    backgroundColor: 'rgba(75, 192, 192, 0.1)',
                                    tension: 0.4,
                                    fill: false
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: true,
                            plugins: {
                                title: {
                                    display: true,
                                    text: 'ä»£å¸æŒä»“å æ¯”è¶‹åŠ¿å›¾',
                                    font: {
                                        size: 16
                                    }
                                },
                                legend: {
                                    display: true,
                                    position: 'top'
                                },
                                tooltip: {
                                    mode: 'index',
                                    intersect: false
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    title: {
                                        display: true,
                                        text: 'æŒä»“å æ¯” (%)'
                                    }
                                },
                                x: {
                                    title: {
                                        display: true,
                                        text: 'æ‰¹æ¬¡æ—¶é—´'
                                    }
                                }
                            }
                        }
                    });
                } else {
                    resultDiv.innerHTML = `
                        <div style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 5px;">
                            <strong>âŒ æŸ¥è¯¢å¤±è´¥</strong><br>
                            ${data.error || 'æœªæ‰¾åˆ°è¯¥ä»£å¸çš„æŒä»“æ•°æ®ï¼Œè¯·ç¡®ä¿è¯¥ä»£å¸å·²ç»æ‰§è¡Œè¿‡åŒæ­¥ä»»åŠ¡'}
                        </div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 5px;">
                        <strong>âŒ è¯·æ±‚å¤±è´¥</strong><br>
                        ${error.message}
                    </div>
                `;
            }
        }

        // åˆ†é¡µçŠ¶æ€ç®¡ç†
        let currentPaginationToken = null;
        let paginationHistory = []; // åˆ†é¡µå†å²æ ˆï¼Œç”¨äºè¿”å›ä¸Šä¸€é¡µ
        let autoQueryAttempts = 0; // è‡ªåŠ¨æŸ¥è¯¢å°è¯•æ¬¡æ•°
        const MAX_AUTO_QUERY_ATTEMPTS = 10; // æœ€å¤§è‡ªåŠ¨æŸ¥è¯¢æ¬¡æ•°ï¼Œé¿å…æ— é™å¾ªç¯

        // æŸ¥è¯¢åœ°å€äº¤æ˜“å†å²
        async function queryAddressTransactions(paginationToken = null, isNextPage = false, isAutoQuery = false) {
            const address = document.getElementById('txAddress').value.trim();
            const limit = parseInt(document.getElementById('txLimit').value) || 50;
            const transactionDetails = 'full'; // å›ºå®šä½¿ç”¨ full æ¨¡å¼
            const sortOrder = document.getElementById('txSortOrder').value;
            const status = document.getElementById('txStatus').value;
            const slotGte = document.getElementById('txSlotGte').value;
            const slotLt = document.getElementById('txSlotLt').value;
            const blockTimeGte = document.getElementById('txBlockTimeGte').value;
            const blockTimeLt = document.getElementById('txBlockTimeLt').value;
            const parseTradeInfo = true; // é»˜è®¤å¯ç”¨è§£æäº¤æ˜“ç±»å‹

            if (!address) {
                alert('è¯·è¾“å…¥åœ°å€');
                return;
            }

            // å¦‚æœæ˜¯æ–°æŸ¥è¯¢ï¼ˆä¸æ˜¯åˆ†é¡µï¼‰ï¼Œé‡ç½®åˆ†é¡µå†å²
            if (!isNextPage && !paginationToken) {
                currentPaginationToken = null;
                paginationHistory = [];
                autoQueryAttempts = 0; // é‡ç½®è‡ªåŠ¨æŸ¥è¯¢æ¬¡æ•°
            }
            
            // å¦‚æœæ˜¯è‡ªåŠ¨æŸ¥è¯¢ï¼Œå¢åŠ å°è¯•æ¬¡æ•°
            if (isAutoQuery) {
                autoQueryAttempts++;
            }

            // å¦‚æœæä¾›äº†åˆ†é¡µä»¤ç‰Œï¼Œä½¿ç”¨å®ƒ
            if (paginationToken) {
                currentPaginationToken = paginationToken;
            }

            const resultDiv = document.getElementById('txResult');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '<div style="text-align: center; padding: 20px;">åŠ è½½ä¸­...</div>';

            try {
                // æ„å»ºæŸ¥è¯¢å‚æ•°
                let queryParams = `limit=${limit}&transactionDetails=${transactionDetails}&sortOrder=${sortOrder}&parseTradeInfo=true`;
                if (status) {
                    queryParams += `&status=${status}`;
                }
                if (slotGte) {
                    queryParams += `&slotGte=${slotGte}`;
                }
                if (slotLt) {
                    queryParams += `&slotLt=${slotLt}`;
                }
                if (blockTimeGte) {
                    // å°† datetime-local æ ¼å¼è½¬æ¢ä¸º Unix æ—¶é—´æˆ³ï¼ˆç§’ï¼‰
                    const timestamp = Math.floor(new Date(blockTimeGte).getTime() / 1000);
                    queryParams += `&blockTimeGte=${timestamp}`;
                }
                if (blockTimeLt) {
                    // å°† datetime-local æ ¼å¼è½¬æ¢ä¸º Unix æ—¶é—´æˆ³ï¼ˆç§’ï¼‰
                    const timestamp = Math.floor(new Date(blockTimeLt).getTime() / 1000);
                    queryParams += `&blockTimeLt=${timestamp}`;
                }
                if (currentPaginationToken) {
                    queryParams += `&paginationToken=${encodeURIComponent(currentPaginationToken)}`;
                }

                const response = await fetch(`/api/address/${address}/transactions?${queryParams}`);
                const data = await response.json();

                if (data.success && data.data && data.data.length > 0) {
                    // å¦‚æœæ‰¾åˆ°äº†æ•°æ®ï¼Œé‡ç½®è‡ªåŠ¨æŸ¥è¯¢æ¬¡æ•°
                    if (isAutoQuery) {
                        autoQueryAttempts = 0;
                    }
                    
                    let html = `
                        <div style="background: #d4edda; color: #155724; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                            <strong>âœ… æŸ¥è¯¢æˆåŠŸ</strong><br>
                            å…±æ‰¾åˆ° ${data.total} ç¬”äº¤æ˜“
                            ${data.paginationToken ? '<br><small>è¿˜æœ‰æ›´å¤šæ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨åˆ†é¡µä»¤ç‰Œè·å–ä¸‹ä¸€é¡µ</small>' : ''}
                            ${isAutoQuery && autoQueryAttempts > 0 ? `<br><small style="color: #856404;">å·²è‡ªåŠ¨è·³è¿‡ ${autoQueryAttempts} é¡µç©ºæ•°æ®</small>` : ''}
                        </div>
                        <div style="max-height: 600px; overflow-y: auto;">
                    `;

                    data.data.forEach((tx, index) => {
                        // å®‰å…¨åœ°è·å– signatureï¼šä¼˜å…ˆä½¿ç”¨ tx.signatureï¼Œå¦‚æœæ²¡æœ‰åˆ™ä» transaction.signatures[0] è·å–
                        const signature = tx.signature || tx.transaction?.signatures?.[0] || 'N/A';
                        
                        const date = tx.blockTime ? new Date(tx.blockTime * 1000).toLocaleString('zh-CN') : 'N/A';
                        const statusColor = tx.err ? '#dc3545' : '#28a745';
                        const statusText = tx.err ? 'âŒ å¤±è´¥' : 'âœ… æˆåŠŸ';
                        const confirmationStatus = tx.confirmationStatus || 'N/A';
                        const hasTradeInfo = tx.tradeInfo !== null && tx.tradeInfo !== undefined;

                        // è§£æäº¤æ˜“ç±»å‹æ˜¾ç¤º
                        let tradeTypeDisplay = '';
                        let tradeTypeColor = '#6c757d';
                        if (hasTradeInfo) {
                            const type = tx.tradeInfo.type;
                            if (type === 'buy') {
                                tradeTypeDisplay = 'ğŸŸ¢ ä¹°å…¥';
                                tradeTypeColor = '#28a745';
                            } else if (type === 'sell') {
                                tradeTypeDisplay = 'ğŸ”´ å–å‡º';
                                tradeTypeColor = '#dc3545';
                            } else if (type === 'swap') {
                                tradeTypeDisplay = 'ğŸ”„ äº¤æ¢';
                                tradeTypeColor = '#17a2b8';
                            } else if (type === 'transfer') {
                                tradeTypeDisplay = 'ğŸ“¤ è½¬ç§»';
                                tradeTypeColor = '#ffc107';
                            } else {
                                tradeTypeDisplay = 'â“ æœªçŸ¥';
                            }
                        }

                        html += `
                            <div style="border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin-bottom: 15px; background: white;">
                                <div style="display: flex; justify-content: space-between; align-items: start; flex-wrap: wrap; gap: 10px; margin-bottom: 10px;">
                                    <div style="flex: 1; min-width: 200px;">
                                        <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">
                                            äº¤æ˜“ #${index + 1}
                                            ${hasTradeInfo ? `<span style="padding: 2px 6px; border-radius: 3px; background: ${tradeTypeColor}; color: white; font-size: 0.8em; margin-left: 8px; font-weight: 600;">${tradeTypeDisplay}</span>` : ''}
                                        </div>
                                        <div style="font-weight: 600; color: #333; margin-bottom: 5px; word-break: break-all;">
                                            ${signature !== 'N/A' ? `
                                            <a href="https://solscan.io/tx/${signature}" target="_blank" style="color: #667eea; text-decoration: none;">
                                                ${signature.length > 28 ? signature.substring(0, 20) + '...' + signature.substring(signature.length - 8) : signature}
                                            </a>
                                            ` : '<span style="color: #999;">ç­¾åä¸å¯ç”¨</span>'}
                                        </div>
                                        <div style="font-size: 0.85em; color: #666;">
                                            <span style="padding: 3px 8px; border-radius: 3px; background: ${statusColor}; color: white; font-size: 0.9em; margin-right: 8px;">
                                                ${statusText}
                                            </span>
                                            <span style="color: #999;">${confirmationStatus}</span>
                                        </div>
                                    </div>
                                    <div style="text-align: right; min-width: 150px;">
                                        <div style="font-size: 0.85em; color: #666; margin-bottom: 5px;">æ—¶é—´</div>
                                        <div style="font-size: 0.9em; color: #333;">${date}</div>
                                    </div>
                                </div>
                                
                                ${hasTradeInfo ? `
                                <div style="margin-top: 10px; padding: 10px; background: #f8f9fa; border-radius: 5px; border-left: 3px solid ${tradeTypeColor};">
                                    <div style="font-size: 0.85em; color: #333; font-weight: 600; margin-bottom: 8px;">äº¤æ˜“è¯¦æƒ…</div>
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; font-size: 0.85em;">
                                        ${tx.tradeInfo.soldToken ? `
                                        <div>
                                            <div style="color: #666; margin-bottom: 3px;">å–å‡ºä»£å¸</div>
                                            <div style="color: #333; font-weight: 500;">
                                                ${tx.tradeInfo.soldToken.mint ? 
                                                    `<a href="https://solscan.io/token/${tx.tradeInfo.soldToken.mint}" target="_blank" style="color: #667eea; text-decoration: none; cursor: pointer; border-bottom: 1px dotted #667eea;" onmouseover="this.style.color='#5568d3'; this.style.borderBottomColor='#5568d3';" onmouseout="this.style.color='#667eea'; this.style.borderBottomColor='#667eea';">${tx.tradeInfo.soldToken.symbol || 'Unknown'}</a>` 
                                                    : (tx.tradeInfo.soldToken.symbol || 'Unknown')
                                                } 
                                                ${tx.tradeInfo.soldToken.amount ? `(${parseFloat(tx.tradeInfo.soldToken.amount).toFixed(4)})` : ''}
                                            </div>
                                        </div>
                                        ` : ''}
                                        ${tx.tradeInfo.boughtToken ? `
                                        <div>
                                            <div style="color: #666; margin-bottom: 3px;">ä¹°å…¥ä»£å¸</div>
                                            <div style="color: #333; font-weight: 500;">
                                                ${tx.tradeInfo.boughtToken.mint ? 
                                                    `<a href="https://solscan.io/token/${tx.tradeInfo.boughtToken.mint}" target="_blank" style="color: #667eea; text-decoration: none; cursor: pointer; border-bottom: 1px dotted #667eea;" onmouseover="this.style.color='#5568d3'; this.style.borderBottomColor='#5568d3';" onmouseout="this.style.color='#667eea'; this.style.borderBottomColor='#667eea';">${tx.tradeInfo.boughtToken.symbol || 'Unknown'}</a>` 
                                                    : (tx.tradeInfo.boughtToken.symbol || 'Unknown')
                                                } 
                                                ${tx.tradeInfo.boughtToken.amount ? `(${parseFloat(tx.tradeInfo.boughtToken.amount).toFixed(4)})` : ''}
                                            </div>
                                        </div>
                                        ` : ''}
                                        ${tx.tradeInfo.price ? `
                                        <div>
                                            <div style="color: #666; margin-bottom: 3px;">ä»·æ ¼</div>
                                            <div style="color: #333; font-weight: 500;">${parseFloat(tx.tradeInfo.price).toFixed(8)}</div>
                                        </div>
                                        ` : ''}
                                        ${tx.tradeInfo.fee ? `
                                        <div>
                                            <div style="color: #666; margin-bottom: 3px;">æ‰‹ç»­è´¹</div>
                                            <div style="color: #333; font-weight: 500;">${parseFloat(tx.tradeInfo.fee).toFixed(6)} SOL</div>
                                        </div>
                                        ` : ''}
                                        ${tx.tradeInfo.dex ? `
                                        <div>
                                            <div style="color: #666; margin-bottom: 3px;">DEX</div>
                                            <div style="color: #333; font-weight: 500;">${tx.tradeInfo.dex}</div>
                                        </div>
                                        ` : ''}
                                        ${tx.tradeInfo.holderAddress ? `
                                        <div>
                                            <div style="color: #666; margin-bottom: 3px;">æŒæœ‰äººåœ°å€</div>
                                            <div style="color: #333; font-weight: 500;">
                                                <a href="https://solscan.io/account/${tx.tradeInfo.holderAddress}" target="_blank" style="color: #667eea; text-decoration: none; cursor: pointer; border-bottom: 1px dotted #667eea; font-family: monospace; font-size: 0.9em;" onmouseover="this.style.color='#5568d3'; this.style.borderBottomColor='#5568d3';" onmouseout="this.style.color='#667eea'; this.style.borderBottomColor='#667eea';">
                                                    ${tx.tradeInfo.holderAddress.length > 20 ? tx.tradeInfo.holderAddress.substring(0, 10) + '...' + tx.tradeInfo.holderAddress.substring(tx.tradeInfo.holderAddress.length - 8) : tx.tradeInfo.holderAddress}
                                                </a>
                                            </div>
                                        </div>
                                        ` : ''}
                                    </div>
                                </div>
                                ` : ''}
                                
                                ${tx.err ? `
                                <div style="margin-top: 10px; padding: 10px; background: #f8d7da; border-radius: 5px; border-left: 3px solid #dc3545;">
                                    <div style="font-size: 0.85em; color: #721c24; font-weight: 600; margin-bottom: 5px;">é”™è¯¯ä¿¡æ¯</div>
                                    <div style="font-size: 0.85em; color: #721c24; font-family: monospace; word-break: break-all;">
                                        ${JSON.stringify(tx.err, null, 2)}
                                    </div>
                                </div>
                                ` : ''}
                            </div>
                        `;
                    });

                    html += `</div>`;

                    // åˆ†é¡µæ§åˆ¶æŒ‰é’®
                    let paginationHtml = '';
                    const currentPage = paginationHistory.length + 1;
                    
                    if (data.paginationToken || paginationHistory.length > 0) {
                        paginationHtml = `
                            <div style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 5px; display: flex; justify-content: space-between; align-items: center; gap: 10px; flex-wrap: wrap;">
                                <div style="flex: 1; min-width: 200px; display: flex; gap: 10px; align-items: center;">
                                    ${paginationHistory.length > 0 ? `
                                    <button onclick="loadPreviousPage()" style="padding: 8px 16px; background: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: 500; transition: background 0.3s;" onmouseover="this.style.background='#5a6268';" onmouseout="this.style.background='#6c757d';">
                                        â† ä¸Šä¸€é¡µ
                                    </button>
                                    ` : ''}
                                    ${paginationHistory.length > 0 ? `
                                    <button onclick="resetPagination()" style="padding: 8px 16px; background: #ffc107; color: #333; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: 500; transition: background 0.3s;" onmouseover="this.style.background='#e0a800';" onmouseout="this.style.background='#ffc107';">
                                        è¿”å›ç¬¬ä¸€é¡µ
                                    </button>
                                    ` : ''}
                                    ${data.paginationToken ? `
                                    <button onclick="loadNextPage()" style="padding: 8px 16px; background: #667eea; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: 500; transition: background 0.3s;" onmouseover="this.style.background='#5568d3';" onmouseout="this.style.background='#667eea';">
                                        ä¸‹ä¸€é¡µ â†’
                                    </button>
                                    ` : ''}
                                </div>
                                <div style="font-size: 0.85em; color: #666;">
                                    ç¬¬ ${currentPage} é¡µ
                                    ${data.paginationToken ? ' | è¿˜æœ‰æ›´å¤šæ•°æ®' : ' | å·²åˆ°æœ€åä¸€é¡µ'}
                                </div>
                            </div>
                        `;
                    }

                    html += paginationHtml;
                    resultDiv.innerHTML = html;

                    // ä¿å­˜åˆ†é¡µä»¤ç‰Œå’Œå†å²
                    if (data.paginationToken) {
                        // å¦‚æœæ˜¯æ–°æŸ¥è¯¢ï¼ˆä¸æ˜¯åˆ†é¡µï¼‰ï¼Œæ¸…ç©ºå†å²
                        if (!isNextPage && !paginationToken) {
                            paginationHistory = [];
                        }
                        // å¦‚æœå½“å‰æœ‰åˆ†é¡µä»¤ç‰Œä¸”æ˜¯ä¸‹ä¸€é¡µæ“ä½œï¼Œå°†å…¶åŠ å…¥å†å²
                        if (currentPaginationToken && isNextPage) {
                            paginationHistory.push(currentPaginationToken);
                        }
                        currentPaginationToken = data.paginationToken;
                    }
                } else if (data.success && data.data && data.data.length === 0) {
                    // å¦‚æœæ•°æ®ä¸ºç©ºä½†æœ‰åˆ†é¡µä»¤ç‰Œï¼Œè¯´æ˜å¯èƒ½è¿˜æœ‰æ›´å¤šæ•°æ®ï¼ˆè¢«è¿‡æ»¤æ‰äº†ï¼‰
                    if (data.paginationToken) {
                        // ä¿å­˜åˆ†é¡µä»¤ç‰Œ
                        if (currentPaginationToken && !paginationToken) {
                            paginationHistory.push(currentPaginationToken);
                        }
                        currentPaginationToken = data.paginationToken;
                        
                        // è‡ªåŠ¨æŸ¥è¯¢ä¸‹ä¸€é¡µï¼ˆå¦‚æœæœªè¶…è¿‡æœ€å¤§å°è¯•æ¬¡æ•°ï¼‰
                        if (!isAutoQuery && autoQueryAttempts < MAX_AUTO_QUERY_ATTEMPTS) {
                            // æ˜¾ç¤ºè‡ªåŠ¨æŸ¥è¯¢æç¤º
                            resultDiv.innerHTML = `
                                <div style="background: #fff3cd; color: #856404; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                                    <strong>âš ï¸ å½“å‰é¡µæ— æœ‰æ•ˆäº¤æ˜“</strong><br>
                                    å½“å‰é¡µçš„æ‰€æœ‰äº¤æ˜“å·²è¢«è¿‡æ»¤ï¼ˆå¯èƒ½åªåŒ…å«ç³»ç»Ÿè¾…åŠ©æŒ‡ä»¤ï¼‰<br>
                                    <small>æ­£åœ¨è‡ªåŠ¨æŸ¥è¯¢ä¸‹ä¸€é¡µ... (${autoQueryAttempts + 1}/${MAX_AUTO_QUERY_ATTEMPTS})</small>
                                </div>
                            `;
                            
                            // å»¶è¿Ÿä¸€ä¸‹å†æŸ¥è¯¢ï¼Œé¿å…è¯·æ±‚è¿‡å¿«
                            setTimeout(() => {
                                queryAddressTransactions(currentPaginationToken, true, true);
                            }, 500);
                            return; // æå‰è¿”å›ï¼Œç­‰å¾…è‡ªåŠ¨æŸ¥è¯¢ç»“æœ
                        } else if (autoQueryAttempts >= MAX_AUTO_QUERY_ATTEMPTS) {
                            // è¶…è¿‡æœ€å¤§å°è¯•æ¬¡æ•°ï¼Œæ˜¾ç¤ºæç¤ºå’Œæ‰‹åŠ¨æŸ¥è¯¢æŒ‰é’®
                            let html = `
                                <div style="background: #fff3cd; color: #856404; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                                    <strong>âš ï¸ è¿ç»­ ${MAX_AUTO_QUERY_ATTEMPTS} é¡µæ— æœ‰æ•ˆäº¤æ˜“</strong><br>
                                    å·²è‡ªåŠ¨æŸ¥è¯¢ ${MAX_AUTO_QUERY_ATTEMPTS} é¡µï¼Œä½†æ‰€æœ‰äº¤æ˜“éƒ½è¢«è¿‡æ»¤æ‰äº†<br>
                                    <small>å¯èƒ½è¯¥åœ°å€çš„äº¤æ˜“ä¸»è¦æ˜¯ç³»ç»Ÿè¾…åŠ©æŒ‡ä»¤ï¼Œæ‚¨å¯ä»¥æ‰‹åŠ¨ç»§ç»­æŸ¥è¯¢ä¸‹ä¸€é¡µ</small>
                                </div>
                                <div style="padding: 15px; background: #f8f9fa; border-radius: 5px; display: flex; justify-content: space-between; align-items: center; gap: 10px; flex-wrap: wrap;">
                                    <div style="flex: 1; min-width: 200px;">
                                        <button onclick="loadNextPage()" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: 500; transition: background 0.3s;" onmouseover="this.style.background='#5568d3';" onmouseout="this.style.background='#667eea';">
                                            ç»§ç»­æŸ¥è¯¢ä¸‹ä¸€é¡µ â†’
                                        </button>
                                    </div>
                                    <div style="font-size: 0.85em; color: #666;">
                                        è¿˜æœ‰æ›´å¤šæ•°æ®å¯ä»¥æŸ¥è¯¢
                                    </div>
                                </div>
                            `;
                            resultDiv.innerHTML = html;
                        } else {
                            // æ‰‹åŠ¨æŸ¥è¯¢çš„æƒ…å†µï¼Œæ˜¾ç¤ºæŒ‰é’®
                            let html = `
                                <div style="background: #fff3cd; color: #856404; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                                    <strong>âš ï¸ å½“å‰é¡µæ— æœ‰æ•ˆäº¤æ˜“</strong><br>
                                    å½“å‰é¡µçš„æ‰€æœ‰äº¤æ˜“å·²è¢«è¿‡æ»¤ï¼ˆå¯èƒ½åªåŒ…å«ç³»ç»Ÿè¾…åŠ©æŒ‡ä»¤ï¼‰ï¼Œä½†è¿˜æœ‰æ›´å¤šæ•°æ®å¯ä»¥æŸ¥è¯¢
                                </div>
                                <div style="padding: 15px; background: #f8f9fa; border-radius: 5px; display: flex; justify-content: space-between; align-items: center; gap: 10px; flex-wrap: wrap;">
                                    <div style="flex: 1; min-width: 200px;">
                                        <button onclick="loadNextPage()" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: 500; transition: background 0.3s;" onmouseover="this.style.background='#5568d3';" onmouseout="this.style.background='#667eea';">
                                            æŸ¥è¯¢ä¸‹ä¸€é¡µ â†’
                                        </button>
                                    </div>
                                    <div style="font-size: 0.85em; color: #666;">
                                        è¿˜æœ‰æ›´å¤šæ•°æ®å¯ä»¥æŸ¥è¯¢
                                    </div>
                                </div>
                            `;
                            resultDiv.innerHTML = html;
                        }
                    } else {
                        // æ²¡æœ‰åˆ†é¡µä»¤ç‰Œï¼Œè¯´æ˜çœŸçš„æ²¡æœ‰æ›´å¤šæ•°æ®äº†
                        resultDiv.innerHTML = `
                            <div style="background: #fff3cd; color: #856404; padding: 15px; border-radius: 5px;">
                                <strong>âš ï¸ æœªæ‰¾åˆ°äº¤æ˜“</strong><br>
                                è¯¥åœ°å€æš‚æ— äº¤æ˜“è®°å½•ï¼Œæˆ–æ‰€æœ‰äº¤æ˜“éƒ½è¢«è¿‡æ»¤æ‰äº†
                                ${autoQueryAttempts > 0 ? `<br><small>å·²è‡ªåŠ¨æŸ¥è¯¢ ${autoQueryAttempts} é¡µ</small>` : ''}
                            </div>
                        `;
                    }
                } else {
                    resultDiv.innerHTML = `
                        <div style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 5px;">
                            <strong>âŒ æŸ¥è¯¢å¤±è´¥</strong><br>
                            ${data.error || 'æœªçŸ¥é”™è¯¯'}
                            ${data.hint ? '<br><small>' + data.hint + '</small>' : ''}
                        </div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 5px;">
                        <strong>âŒ æŸ¥è¯¢å¤±è´¥</strong><br>
                        ${error.message}
                    </div>
                `;
            }
        }

        // åŠ è½½ä¸‹ä¸€é¡µ
        function loadNextPage() {
            if (currentPaginationToken) {
                queryAddressTransactions(currentPaginationToken, true);
            }
        }

        // åŠ è½½ä¸Šä¸€é¡µï¼ˆä»å†å²ä¸­æ¢å¤ï¼‰
        function loadPreviousPage() {
            if (paginationHistory.length > 0) {
                // ç§»é™¤å½“å‰ä»¤ç‰Œï¼ˆå› ä¸ºæˆ‘ä»¬è¦è¿”å›ä¸Šä¸€é¡µï¼‰
                if (currentPaginationToken) {
                    // ä¸éœ€è¦ç§»é™¤ï¼Œå› ä¸ºæˆ‘ä»¬è¦ä½¿ç”¨å†å²ä¸­çš„ä¸Šä¸€ä¸ªä»¤ç‰Œ
                }
                // ä»å†å²ä¸­å–å‡ºä¸Šä¸€ä¸ªä»¤ç‰Œ
                const previousToken = paginationHistory.pop();
                // æ›´æ–°å½“å‰ä»¤ç‰Œä¸ºä¸Šä¸€ä¸ªä»¤ç‰Œ
                currentPaginationToken = previousToken;
                // æŸ¥è¯¢ä¸Šä¸€é¡µ
                queryAddressTransactions(previousToken, false);
            }
        }

        // é‡ç½®åˆ†é¡µï¼Œè¿”å›ç¬¬ä¸€é¡µ
        function resetPagination() {
            currentPaginationToken = null;
            paginationHistory = [];
            queryAddressTransactions(null, false);
        }

        async function queryAddressHistory() {
            const address = document.getElementById('historyAddress').value.trim();
            const limit = parseInt(document.getElementById('historyLimit').value) || 100;

            if (!address) {
                alert('è¯·è¾“å…¥åœ°å€');
                return;
            }

            const resultDiv = document.getElementById('historyResult');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '<div style="text-align: center; padding: 20px;">åŠ è½½ä¸­...</div>';

            try {
                const response = await fetch(`/api/address/${address}/transactions/history?limit=${limit}`);
                const data = await response.json();

                if (data.success && data.transactions && data.transactions.length > 0) {
                    let html = `
                        <div style="background: #d4edda; color: #155724; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                            <strong>âœ… æŸ¥è¯¢æˆåŠŸ</strong><br>
                            å…±æ‰¾åˆ° ${data.total} ç¬”äº¤æ˜“
                        </div>
                        <div style="max-height: 600px; overflow-y: auto;">
                    `;

                    data.transactions.forEach((tx, index) => {
                        // å®‰å…¨åœ°è·å– signatureï¼šä¼˜å…ˆä½¿ç”¨ tx.signatureï¼Œå¦‚æœæ²¡æœ‰åˆ™ä» transaction.signatures[0] è·å–
                        const signature = tx.signature || tx.transaction?.signatures?.[0] || 'N/A';
                        
                        // è·å–äº¤æ˜“ç±»å‹å’Œæ ‡ç­¾
                        const transactionType = tx.transactionType || 'unknown';
                        let typeLabel = 'â“ æœªçŸ¥';
                        let typeBgColor = '#fff3cd';
                        let typeTextColor = '#856404';
                        
                        if (transactionType === 'buy') {
                            typeLabel = 'ğŸŸ¢ ä¹°å…¥';
                            typeBgColor = '#d4edda';
                            typeTextColor = '#155724';
                        } else if (transactionType === 'sell') {
                            typeLabel = 'ğŸ”´ å–å‡º';
                            typeBgColor = '#f8d7da';
                            typeTextColor = '#721c24';
                        } else if (transactionType === 'transfer') {
                            typeLabel = 'ğŸ”„ è½¬è´¦';
                            typeBgColor = '#d1ecf1';
                            typeTextColor = '#0c5460';
                        }
                        
                        // æ ¼å¼åŒ–é‡‘é¢æ˜¾ç¤º
                        let amountDisplay = 'N/A';
                        if (tx.solAmount !== null && tx.solAmount !== undefined) {
                            amountDisplay = `${tx.solAmount.toFixed(4)} SOL`;
                        } else if (tx.amount !== null && tx.amount !== undefined) {
                            amountDisplay = `${tx.amount.toFixed(4)} SOL`;
                        }
                        
                        html += `
                            <div style="border: 1px solid #ddd; border-radius: 5px; padding: 15px; margin-bottom: 10px; background: #f9f9f9; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px;">
                                <div style="flex: 1; min-width: 200px;">
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 5px;">
                                        <span style="padding: 4px 8px; border-radius: 4px; font-size: 0.9em; background: ${typeBgColor}; color: ${typeTextColor}; font-weight: 600;">
                                            ${typeLabel}
                                        </span>
                                        <span style="font-weight: bold; color: #333; font-size: 1em;">
                                            ${amountDisplay}
                                        </span>
                                    </div>
                                    <div style="font-size: 0.85em; color: #666; margin-bottom: 3px;">
                                        <strong>æ—¶é—´:</strong> ${tx.dateFormatted || 'N/A'}
                                    </div>
                                    <div style="font-size: 0.85em; color: #666;">
                                        <strong>ç­¾å:</strong> 
                                        ${signature !== 'N/A' ? `
                                        <a href="https://solscan.io/tx/${signature}" target="_blank" style="color: #667eea; text-decoration: none; font-family: monospace;">
                                            ${signature.length > 24 ? signature.substring(0, 16) + '...' + signature.substring(signature.length - 8) : signature}
                                        </a>
                                        ` : '<span style="color: #999;">ç­¾åä¸å¯ç”¨</span>'}
                                    </div>
                                </div>
                            </div>
                        `;
                    });

                    html += `</div>`;
                    resultDiv.innerHTML = html;
                } else {
                    resultDiv.innerHTML = `
                        <div style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 5px;">
                            <strong>âŒ æŸ¥è¯¢å¤±è´¥</strong><br>
                            ${data.error || 'æœªæ‰¾åˆ°è¯¥åœ°å€çš„äº¤æ˜“å†å²'}
                        </div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 5px;">
                        <strong>âŒ è¯·æ±‚å¤±è´¥</strong><br>
                        ${error.message}
                    </div>
                `;
            }
        }

        // åŠ è½½å®šæ—¶ä»»åŠ¡åˆ—è¡¨
        async function loadScheduledJobs() {
            const listDiv = document.getElementById('scheduledJobsList');
            listDiv.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">åŠ è½½ä¸­...</div>';

            try {
                const response = await fetch('/api/jobs/scheduled');
                const data = await response.json();

                if (data.success && data.jobs && data.jobs.length > 0) {
                    let html = '<div style="display: grid; gap: 15px;">';
                    data.jobs.forEach(job => {
                        const statusColor = job.running ? '#d4edda' : '#f8d7da';
                        const statusText = job.running ? 'âœ… è¿è¡Œä¸­' : 'â¸ï¸ å·²åœæ­¢';
                        const statusTextColor = job.running ? '#155724' : '#721c24';
                        const buttonText = job.running ? 'åœæ­¢' : 'å¯åŠ¨';
                        const buttonAction = job.running ? 'stop' : 'start';
                        const buttonBg = job.running ? '#dc3545' : '#28a745';

                        html += `
                            <div style="border: 1px solid #ddd; border-radius: 8px; padding: 20px; background: #f9f9f9;">
                                <div style="display: flex; justify-content: space-between; align-items: start; flex-wrap: wrap; gap: 15px;">
                                    <div style="flex: 1; min-width: 200px;">
                                        <h4 style="margin: 0 0 10px 0; color: #333; font-size: 1.1em;">${job.name}</h4>
                                        <div style="margin-bottom: 8px;">
                                            <span style="padding: 4px 8px; border-radius: 4px; background: ${statusColor}; color: ${statusTextColor}; font-size: 0.9em; font-weight: 600;">
                                                ${statusText}
                                            </span>
                                        </div>
                                        <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">
                                            <strong>ä»»åŠ¡ID:</strong> <code style="background: #f0f0f0; padding: 2px 6px; border-radius: 3px;">${job.id}</code>
                                        </div>
                                        <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">
                                            <strong>æ‰§è¡Œè®¡åˆ’:</strong> <code style="background: #f0f0f0; padding: 2px 6px; border-radius: 3px;">${job.schedule}</code>
                                        </div>
                                        <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">
                                            <strong>é˜Ÿåˆ—:</strong> ${job.queue}
                                        </div>
                                        ${job.data.tokenAddresses ? `
                                            <div style="font-size: 0.9em; color: #666; margin-top: 10px;">
                                                <strong>ä»£å¸åœ°å€:</strong>
                                                <div style="margin-top: 5px;">
                                                    ${job.data.tokenAddresses.map(addr => `
                                                        <code style="background: #f0f0f0; padding: 2px 6px; border-radius: 3px; display: inline-block; margin: 2px; font-size: 0.85em;">${addr}</code>
                                                    `).join('')}
                                                </div>
                                            </div>
                                        ` : ''}
                                    </div>
                                    <div style="display: flex; gap: 10px; align-items: center;">
                                        <button 
                                            onclick="toggleScheduledJob('${job.id}', '${buttonAction}')"
                                            style="background: ${buttonBg}; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 14px; font-weight: 500; transition: background 0.3s;"
                                            onmouseover="this.style.opacity='0.8'"
                                            onmouseout="this.style.opacity='1'"
                                        >
                                            ${buttonText}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                    html += '</div>';
                    listDiv.innerHTML = html;
                } else {
                    listDiv.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">æš‚æ— å®šæ—¶ä»»åŠ¡</div>';
                }
            } catch (error) {
                listDiv.innerHTML = `<div style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 5px;">åŠ è½½å¤±è´¥: ${error.message}</div>`;
            }
        }

        // å¯åŠ¨/åœæ­¢å®šæ—¶ä»»åŠ¡
        async function toggleScheduledJob(jobId, action) {
            try {
                const response = await fetch(`/api/jobs/scheduled/${jobId}/${action}`, {
                    method: 'POST'
                });
                const data = await response.json();

                if (data.success) {
                    alert(data.message || `ä»»åŠ¡å·²${action === 'start' ? 'å¯åŠ¨' : 'åœæ­¢'}`);
                    loadScheduledJobs(); // åˆ·æ–°åˆ—è¡¨
                } else {
                    alert('æ“ä½œå¤±è´¥: ' + data.error);
                }
            } catch (error) {
                alert('æ“ä½œå¤±è´¥: ' + error.message);
            }
        }

        // åŠ è½½å¯ç”¨ä»»åŠ¡åˆ—è¡¨
        async function loadTasks() {
            const taskListDiv = document.getElementById('taskList');
            try {
                const response = await fetch('/api/jobs/tasks');
                const data = await response.json();
                
                if (data.success && data.tasks && data.tasks.length > 0) {
                    let html = '<div style="display: grid; gap: 15px;">';
                    data.tasks.forEach(task => {
                        html += `
                            <div style="border: 1px solid #ddd; border-radius: 8px; padding: 15px; background: #f9f9f9;">
                                <h4 style="margin: 0 0 8px 0; color: #333;">${task.name}</h4>
                                <p style="margin: 0 0 10px 0; color: #666; font-size: 0.9em;">${task.description}</p>
                                <div style="font-size: 0.85em; color: #666;">
                                    <strong>ä»»åŠ¡ID:</strong> <code style="background: #f0f0f0; padding: 2px 6px; border-radius: 3px;">${task.taskId}</code>
                                </div>
                            </div>
                        `;
                    });
                    html += '</div>';
                    taskListDiv.innerHTML = html;
                } else {
                    taskListDiv.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">æš‚æ— å¯ç”¨ä»»åŠ¡</div>';
                }
            } catch (error) {
                taskListDiv.innerHTML = `<div style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 5px;">åŠ è½½å¤±è´¥: ${error.message}</div>`;
            }
        }

        // åŠ è½½é˜Ÿåˆ—çŠ¶æ€
        async function refreshQueueStatus() {
            const statusDiv = document.getElementById('queueStatus');
            try {
                const response = await fetch('/api/jobs/queue/tokenSync/status');
                const data = await response.json();
                
                if (data.success && data.status) {
                    const status = data.status;
                    statusDiv.innerHTML = `
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                            <div style="text-align: center; padding: 15px; background: #f8f9fa; border-radius: 5px;">
                                <div style="color: #666; font-size: 0.9em; margin-bottom: 5px;">ç­‰å¾…ä¸­</div>
                                <div style="font-size: 2em; font-weight: bold; color: #333;">${status.waiting}</div>
                            </div>
                            <div style="text-align: center; padding: 15px; background: #f8f9fa; border-radius: 5px;">
                                <div style="color: #666; font-size: 0.9em; margin-bottom: 5px;">æ‰§è¡Œä¸­</div>
                                <div style="font-size: 2em; font-weight: bold; color: #333;">${status.active}</div>
                            </div>
                            <div style="text-align: center; padding: 15px; background: #d4edda; border-radius: 5px;">
                                <div style="color: #155724; font-size: 0.9em; margin-bottom: 5px;">å·²å®Œæˆ</div>
                                <div style="font-size: 2em; font-weight: bold; color: #155724;">${status.completed}</div>
                            </div>
                            <div style="text-align: center; padding: 15px; background: #f8d7da; border-radius: 5px;">
                                <div style="color: #721c24; font-size: 0.9em; margin-bottom: 5px;">å¤±è´¥</div>
                                <div style="font-size: 2em; font-weight: bold; color: #721c24;">${status.failed}</div>
                            </div>
                            <div style="text-align: center; padding: 15px; background: #f8f9fa; border-radius: 5px;">
                                <div style="color: #666; font-size: 0.9em; margin-bottom: 5px;">æ€»è®¡</div>
                                <div style="font-size: 2em; font-weight: bold; color: #333;">${status.total}</div>
                            </div>
                        </div>
                    `;
                } else {
                    statusDiv.innerHTML = '<div style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 5px;">åŠ è½½å¤±è´¥</div>';
                }
            } catch (error) {
                statusDiv.innerHTML = `<div style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 5px;">åŠ è½½å¤±è´¥: ${error.message}</div>`;
            }
        }

        // æ·»åŠ ç›‘æ§åœ°å€
        async function addMonitorAddress() {
            const address = document.getElementById('monitorAddress').value.trim();
            const encoding = document.getElementById('monitorEncoding').value;
            const commitment = document.getElementById('monitorCommitment').value;

            if (!address) {
                alert('è¯·è¾“å…¥è¦ç›‘æ§çš„åœ°å€');
                return;
            }

            try {
                const params = new URLSearchParams({
                    encoding: encoding,
                    commitment: commitment
                });

                const response = await fetch(`/api/address/${address}/subscribe?${params}`, {
                    method: 'POST'
                });
                const data = await response.json();

                if (data.success) {
                    alert('âœ… ' + data.message);
                    // æ¸…ç©ºè¾“å…¥æ¡†
                    document.getElementById('monitorAddress').value = '';
                    // åˆ·æ–°åˆ—è¡¨
                    loadMonitorConnections();
                } else {
                    alert('âŒ æ·»åŠ å¤±è´¥: ' + (data.error || 'æœªçŸ¥é”™è¯¯'));
                }
            } catch (error) {
                alert('âŒ è¯·æ±‚å¤±è´¥: ' + error.message);
            }
        }

        // åŠ è½½ç›‘æ§è¿æ¥åˆ—è¡¨
        async function loadMonitorConnections() {
            const listDiv = document.getElementById('monitorConnectionsList');
            listDiv.innerHTML = '<div style="text-align: center; padding: 20px; color: #666;">åŠ è½½ä¸­...</div>';

            try {
                const response = await fetch('/api/address/connections');
                const data = await response.json();

                if (data.success) {
                    if (data.connections && data.connections.length > 0) {
                        let html = `
                            <div style="background: #d4edda; color: #155724; padding: 15px; border-radius: 5px; margin-bottom: 20px;">
                                <strong>âœ… å½“å‰ç›‘æ§ ${data.count} ä¸ªåœ°å€</strong>
                            </div>
                            <div style="display: grid; gap: 15px;">
                        `;
                        
                        data.connections.forEach(conn => {
                            const createdAt = conn.createdAt ? new Date(conn.createdAt).toLocaleString('zh-CN') : 'N/A';
                            const connectedAt = conn.connectedAt ? new Date(conn.connectedAt).toLocaleString('zh-CN') : 'N/A';
                            const lastMessageTime = conn.lastMessageTime ? new Date(conn.lastMessageTime).toLocaleString('zh-CN') : 'N/A';
                            const timeSinceLastMessage = conn.timeSinceLastMessage !== undefined ? conn.timeSinceLastMessage : 'N/A';
                            
                            // è¿æ¥çŠ¶æ€åˆ¤æ–­
                            const readyStateText = {
                                0: 'CONNECTING',
                                1: 'OPEN âœ…',
                                2: 'CLOSING',
                                3: 'CLOSED âŒ'
                            };
                            const readyState = readyStateText[conn.readyState] || conn.readyState || 'N/A';
                            const isConnected = conn.readyState === 1;
                            
                            // è¿æ¥çŠ¶æ€é¢œè‰²
                            let statusColor = '#d4edda';
                            let statusTextColor = '#155724';
                            let statusText = 'âœ… ç›‘æ§ä¸­';
                            
                            if (!isConnected) {
                                statusColor = '#f8d7da';
                                statusTextColor = '#721c24';
                                statusText = 'âŒ è¿æ¥æ–­å¼€';
                            } else if (timeSinceLastMessage !== 'N/A' && timeSinceLastMessage > 120) {
                                statusColor = '#fff3cd';
                                statusTextColor = '#856404';
                                statusText = 'âš ï¸ è¿æ¥å¼‚å¸¸';
                            }
                            
                            html += `
                                <div style="border: 1px solid #ddd; border-radius: 8px; padding: 20px; background: #f9f9f9;">
                                    <div style="display: flex; justify-content: space-between; align-items: start; flex-wrap: wrap; gap: 15px;">
                                        <div style="flex: 1; min-width: 200px;">
                                            <h4 style="margin: 0 0 10px 0; color: #333; font-size: 1.1em;">
                                                <span style="padding: 4px 8px; border-radius: 4px; background: ${statusColor}; color: ${statusTextColor}; font-size: 0.9em; font-weight: 600; margin-right: 10px;">
                                                    ${statusText}
                                                </span>
                                                åœ°å€ç›‘æ§
                                            </h4>
                                            <div style="font-size: 0.9em; color: #666; margin-bottom: 8px;">
                                                <strong>åœ°å€:</strong> 
                                                <code style="background: #f0f0f0; padding: 4px 8px; border-radius: 3px; font-family: monospace; word-break: break-all;">
                                                    ${conn.address}
                                                </code>
                                            </div>
                                            
                                            <div style="background: #f8f9fa; padding: 12px; border-radius: 5px; margin: 10px 0;">
                                                <div style="font-size: 0.85em; color: #666; margin-bottom: 8px; font-weight: 600;">è¿æ¥çŠ¶æ€</div>
                                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 8px; font-size: 0.85em;">
                                                    <div>
                                                        <div style="color: #999;">WebSocket çŠ¶æ€</div>
                                                        <div style="color: #333; font-weight: 500;">${readyState}</div>
                                                    </div>
                                                    <div>
                                                        <div style="color: #999;">è®¢é˜…ID</div>
                                                        <div style="color: #333; font-weight: 500; font-family: monospace;">${conn.subscriptionId || 'N/A'}</div>
                                                    </div>
                                                    <div>
                                                        <div style="color: #999;">è¿æ¥å»ºç«‹æ—¶é—´</div>
                                                        <div style="color: #333; font-weight: 500;">${connectedAt}</div>
                                                    </div>
                                                    <div>
                                                        <div style="color: #999;">æœ€åæ¶ˆæ¯æ—¶é—´</div>
                                                        <div style="color: #333; font-weight: 500;">${lastMessageTime}</div>
                                                    </div>
                                                    <div>
                                                        <div style="color: #999;">è·ç¦»æœ€åæ¶ˆæ¯</div>
                                                        <div style="color: ${timeSinceLastMessage !== 'N/A' && timeSinceLastMessage > 60 ? '#dc3545' : '#333'}; font-weight: 500;">
                                                            ${timeSinceLastMessage !== 'N/A' ? timeSinceLastMessage + ' ç§’' : 'N/A'}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">
                                                <strong>ç¼–ç æ ¼å¼:</strong> ${conn.encoding || 'jsonParsed'}
                                            </div>
                                            <div style="font-size: 0.9em; color: #666; margin-bottom: 5px;">
                                                <strong>ç¡®è®¤çº§åˆ«:</strong> ${conn.commitment || 'confirmed'}
                                            </div>
                                            <div style="font-size: 0.9em; color: #666;">
                                                <strong>åˆ›å»ºæ—¶é—´:</strong> ${createdAt}
                                            </div>
                                        </div>
                                        <div style="display: flex; gap: 10px; align-items: center;">
                                            <button 
                                                onclick="removeMonitorAddress('${conn.address}')"
                                                style="background: #dc3545; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 14px; font-weight: 500; transition: background 0.3s;"
                                                onmouseover="this.style.background='#c82333'"
                                                onmouseout="this.style.background='#dc3545'"
                                            >
                                                ğŸ—‘ï¸ å–æ¶ˆç›‘æ§
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            `;
                        });
                        
                        html += '</div>';
                        listDiv.innerHTML = html;
                    } else {
                        listDiv.innerHTML = `
                            <div style="text-align: center; padding: 40px; color: #666;">
                                <div style="font-size: 3em; margin-bottom: 10px;">ğŸ‘ï¸</div>
                                <div style="font-size: 1.1em; margin-bottom: 5px;">æš‚æ— ç›‘æ§åœ°å€</div>
                                <div style="font-size: 0.9em; color: #999;">åœ¨ä¸Šæ–¹æ·»åŠ åœ°å€å¼€å§‹ç›‘æ§</div>
                            </div>
                        `;
                    }
                } else {
                    listDiv.innerHTML = `
                        <div style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 5px;">
                            åŠ è½½å¤±è´¥: ${data.error || 'æœªçŸ¥é”™è¯¯'}
                        </div>
                    `;
                }
            } catch (error) {
                listDiv.innerHTML = `
                    <div style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 5px;">
                        åŠ è½½å¤±è´¥: ${error.message}
                    </div>
                `;
            }
        }

        // å–æ¶ˆç›‘æ§åœ°å€
        async function removeMonitorAddress(address) {
            if (!confirm(`ç¡®å®šè¦å–æ¶ˆç›‘æ§åœ°å€ ${address.substring(0, 16)}... å—ï¼Ÿ`)) {
                return;
            }

            try {
                const response = await fetch(`/api/address/${address}/unsubscribe`, {
                    method: 'POST'
                });
                const data = await response.json();

                if (data.success) {
                    alert('âœ… ' + data.message);
                    // åˆ·æ–°åˆ—è¡¨
                    loadMonitorConnections();
                } else {
                    alert('âŒ å–æ¶ˆç›‘æ§å¤±è´¥: ' + (data.error || 'æœªçŸ¥é”™è¯¯'));
                }
            } catch (error) {
                alert('âŒ è¯·æ±‚å¤±è´¥: ' + error.message);
            }
        }

        // åŒæ­¥äº¤æ˜“åˆ°æ•°æ®åº“
        async function syncTradesToDatabase() {
            const address = document.getElementById('syncAddress').value.trim();
            const blockTimeGteInput = document.getElementById('syncBlockTimeGte').value.trim();
            const blockTimeLtInput = document.getElementById('syncBlockTimeLt').value.trim();
            const maxDuration = document.getElementById('syncMaxDuration').value || '900000';
            const maxPages = document.getElementById('syncMaxPages').value || '500';
            const skipTimezoneConversion = document.getElementById('syncSkipTimezoneConversion').checked;

            if (!address) {
                alert('è¯·è¾“å…¥åœ°å€');
                return;
            }

            if (!blockTimeGteInput || !blockTimeLtInput) {
                alert('è¯·é€‰æ‹©å¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´');
                return;
            }

            // å°† datetime-local æ ¼å¼è½¬æ¢ä¸º Unix æ—¶é—´æˆ³ï¼ˆç§’ï¼‰
            // datetime-local è¿”å›çš„æ˜¯æœ¬åœ°æ—¶é—´ï¼Œéœ€è¦è½¬æ¢ä¸º UTC æ—¶é—´æˆ³
            const blockTimeGte = Math.floor(new Date(blockTimeGteInput).getTime() / 1000);
            const blockTimeLt = Math.floor(new Date(blockTimeLtInput).getTime() / 1000);

            const resultDiv = document.getElementById('syncResult');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '<div style="text-align: center; padding: 20px;">æ­£åœ¨å¯åŠ¨åŒæ­¥ä»»åŠ¡...</div>';

            try {
                const params = new URLSearchParams({
                    blockTimeGte: blockTimeGte,
                    blockTimeLt: blockTimeLt,
                    maxDuration: maxDuration,
                    maxPages: maxPages,
                    skipTimezoneConversion: skipTimezoneConversion ? 'true' : 'false'
                });

                const response = await fetch(`/api/address/${address}/sync-trades?${params}`);
                const data = await response.json();

                if (data.success) {
                    resultDiv.innerHTML = `
                        <div style="background: #d4edda; color: #155724; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                            <strong>âœ… åŒæ­¥ä»»åŠ¡å·²å¯åŠ¨</strong><br>
                            ${data.message || 'ä»»åŠ¡æ­£åœ¨åå°æ‰§è¡Œ'}
                        </div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                            <div style="font-size: 0.9em; color: #666; margin-bottom: 10px;"><strong>ä»»åŠ¡ä¿¡æ¯ï¼š</strong></div>
                            <div style="font-size: 0.85em; color: #333;">
                                <div style="margin-bottom: 5px;"><strong>åœ°å€ï¼š</strong><code style="background: #fff; padding: 2px 6px; border-radius: 3px; font-family: monospace;">${data.address}</code></div>
                                <div style="margin-bottom: 5px;"><strong>æ—¶åŒºï¼š</strong>${data.timezone || 'N/A'}</div>
                                <div style="margin-bottom: 5px;"><strong>è¯´æ˜ï¼š</strong>${data.note || 'N/A'}</div>
                            </div>
                        </div>
                        <div style="background: #d1ecf1; color: #0c5460; padding: 15px; border-radius: 5px;">
                            <strong>â„¹ï¸ æç¤º</strong><br>
                            <small>
                                åŒæ­¥ä»»åŠ¡åœ¨åå°å¼‚æ­¥æ‰§è¡Œï¼Œè¯·æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—äº†è§£åŒæ­¥è¿›åº¦å’Œç»“æœã€‚<br>
                                ä»»åŠ¡ä¼šæ ¹æ®è¿‡æ»¤æ¡ä»¶è‡ªåŠ¨ä¿å­˜ç¬¦åˆæ¡ä»¶çš„ä¹°å…¥äº¤æ˜“ï¼ˆbuy å’Œ swapï¼‰åˆ°æ•°æ®åº“ã€‚
                            </small>
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 5px;">
                            <strong>âŒ å¯åŠ¨å¤±è´¥</strong><br>
                            ${data.error || 'æœªçŸ¥é”™è¯¯'}
                            ${data.hint ? '<br><small>' + data.hint + '</small>' : ''}
                        </div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div style="background: #f8d7da; color: #721c24; padding: 15px; border-radius: 5px;">
                        <strong>âŒ è¯·æ±‚å¤±è´¥</strong><br>
                        ${error.message}
                    </div>
                `;
            }
        }

        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºç¬¬ä¸€ä¸ªèœå•é¡¹çš„å†…å®¹
        window.onload = function() {
            showSection('token-holders', document.querySelector('.menu-item a'));
            // é¢„åŠ è½½ä»»åŠ¡ç®¡ç†æ•°æ®
            loadScheduledJobs();
            loadTasks();
            refreshQueueStatus();
            // é¢„åŠ è½½åœ°å€ç›‘æ§åˆ—è¡¨
            loadMonitorConnections();
        };
    </script>
</body>
</html>

